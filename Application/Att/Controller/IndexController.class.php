<?php/** * Created by PhpStorm. * User: wangsfox * Date: 2017/10/10 * Time: 18:39 */namespace Att\Controller;use Think\Controller;class IndexController extends Controller{    //签到    public $_info, $_Att;    public function _initialize()    {        $this->_Att = M('att');    }    public function index()    {        $this->_info = cookie('info');        if ($this->_info) $this->show();        if (I('submit')) {            $data = [                'name' => I('name'),                'phone' => I('phone'),                'company' => I('company'),                'dept' => I('dept'),                'regtime' => time()            ];            $_cookie = [                'name' => $data['name'],                'phone' => $data['phone']            ];            //存cookie            cookie('info', $_cookie);            $userinfo = $this->_Att->where($_cookie)->find();            if ($userinfo) {                $this->_info = $userinfo;                $isok = $this->_Att->where(['id' => $userinfo['id']])->save($data);                if ($isok) {                    $this->success('签到成功', U('show'));                } else {                    $this->error('签到失败,可能是没有录入您的信息,请联系现场签到人员');                }            } else {                $this->error('签到失败,可能是您输入的信息有误,请检查输入信息是否正确');            }        } else {            $this->display();        }    }    //显示信息    public function show()    {        $show = $this->_Att->where($this->_info)->find();        $this->assign('att', $show);        $this->display();    }}